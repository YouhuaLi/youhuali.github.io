<!DOCTYPE html><html lang="zh">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>比特币原理浅说（上） - 大老李聊数学</title>

<meta name="description" content="(本文原系本人“喜马拉雅”平台上一期节目，因故下架。现转文字形式发表。因从音频转录为文字，文字风格较为口语化，请谅解。)大家好，我是大老李。这期我准备跟大家聊聊比特币。为什么要讲比特币，很明显比特币现在这个话题实在太火爆了。我在录节目的这个时刻（2017年2月），一个比特币的汇率达到了一千多美元，就是一个比特币，...">
<link rel="canonical" href="http://localhost:4000/2017/11/08/e6-af-94-e7-89-b9-e5-b8-81-e5-8e-9f-e7-90-86-e6-b5-85-e8-af-b4-ef-bc-88-e4-b8-8a-ef-bc-89.html"><link rel="alternate" type="application/rss+xml" title="大老李聊数学" href="/feed.xml">
<!-- begin favicon --><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="manifest" href="/assets/site.webmanifest"><link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicon --><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" >
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.decodeUrl = function(str) {
    return str ? decodeURIComponent(str.replace(/\+/g, '%20')) : '';
  };


  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i, cb; loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cb = cbs[i]; cb();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();</script><script>
  (function() {
    var TEXT_VARIABLES = {
      sources: {
        font_awesome: 'https://use.fontawesome.com/releases/v5.0.13/css/all.css',
        jquery: 'https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn1.lncld.net/static/js/3.4.1/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.1/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/7.1.2/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script></head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main has-aside">

    <div class="page__main-inner">
      <div></div><div class="page__header"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="24px" height="24px" viewBox="0 0 24 24">
<style type="text/css">
	.st0{fill:#515151;}
</style>
<path class="st0" d="M1.7,22.3c5.7-5.7,11.3-5.7,17,0c3.3-3.3,3.5-5.3,0.8-6c2.7,0.7,3.5-1.1,2.3-5.6s-3.3-5.2-6.3-2.1
	c3-3,2.3-5.2-2.1-6.3S7,1.8,7.7,4.6C7,1.8,5,2.1,1.7,5.3C7.3,11,7.3,16.7,1.7,22.3"/>
</svg><a title="Your Site Description
" href="/">大老李聊数学</a></div>
        <button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button>
      </div><nav class="navigation">
        <ul><li class="navigation__link"><a href="/archive.html">归档</a></li><li class="navigation__link"><a href="/about.html">关于</a></li><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li>
        </ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class ="main"><div class="grid grid--reverse">

             <div class="col-aside js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div></aside></div>

            <div class="col-main cell--auto"><article><div class="article__header"><header><h1>比特币原理浅说（上）</h1></header><span class="split-space">&nbsp;</span>
          <a class="edit-on-github"
            title="在 Github 上修改"
            href="https://github.com/dalaoli-shuxue/dalaoli-shuxue/tree/master/_posts/2017-11-08-%e6%af%94%e7%89%b9%e5%b8%81%e5%8e%9f%e7%90%86%e6%b5%85%e8%af%b4%ef%bc%88%e4%b8%8a%ef%bc%89.html">
            <i class="far fa-edit"></i></a></div><meta itemprop="headline" content="比特币原理浅说（上）"><div class="article__info clearfix"><ul class="right-col menu"><li><i class="fas fa-user"></i> <span>大老李</span></li><li><i class="far fa-calendar-alt"></i> <span>2017年 11月08日</span>
            </li></ul></div><meta itemprop="author" content="大老李"/><meta itemprop="datePublished" content="2017-11-08T12:43:24+00:00"><div class="js-article-content"><p>(本文原系本人“喜马拉雅”平台上一期节目，因故下架。现转文字形式发表。因从音频转录为文字，文字风格较为口语化，请谅解。)</p>
<p><img class="alignnone size-full wp-image-588" src="https://dalaoliblog.files.wordpress.com/2017/11/bitcoin.jpeg" alt="bitcoin.jpeg" width="300" height="168" /></p>
<p>大家好，我是大老李。这期我准备跟大家聊聊比特币。为什么要讲比特币，很明显比特币现在这个话题实在太火爆了。我在录节目的这个时刻（2017年2月），一个比特币的汇率达到了一千多美元，就是一个比特币，可以换一千多美元（2017年11月是七千多美元）！每当我看见这个数字，我每次都会感慨，如果早几年，比如说2009年，我就参与这个游戏，多挖几个比特币，那我现在也就不需要在这边给大家讲什么比特币原理了，那也是废话了。</p>
<p>但我要声明一下，我讲这个节目并不是鼓励大家去买什么比特币，我只是从数学原理上跟大家探讨一下比特币这套游戏能够运行的一些原理，当中也用到了很多数学知识，而且我自己本人也很遗憾的告诉大家我至今没有任何的比特币。另外，我在研究比特币的时候，我发现比特币的发明者就是这个叫中本聪的这个人，这个人的身份到目前都是一个迷，关于他的身份有各种各样的猜测说法，过去几年也发生过大大小小的一些新闻事件，这些故事相当精彩，简直可以堪比一场谍战剧，所以我准备将来跟大家聊聊这个中本聪的身份之谜，但这是下一期了，在讲比特币原理之前，我先要讲一个准备知识，这个准备知识是比特币里面非常重要的一个准备知识，叫做非对称加密体系。<br />
什么叫非对称加密体系？先讲讲什么叫对称加密体系吧。对称交易体系，简而言之就是对一串信息加密和解密用的是同一把密钥。比如说我们可能用过Word软件里面的那个密码功能，如果我的文件有一些敏感信息，需要发给另外一个人，那我会给这个Word文件设置一个密码，然后对方在打开这个这个文件的时候，需要同样的这个密码，正确的输入这个密码才能打开这个我文件。我可以通过打电话或者其他方法告诉对方，你要打开我的文件，需要输入同样的密码，这就是所谓的对称加密体系。也就是说加解密同一把密钥，同一个密码。</p>
<p>&nbsp;</p>
<p>那非对称加密体系是怎么样情况，就是每一个人会产生两把密钥，一个叫做公钥，一个叫私钥。所谓公钥就是公共的公，公钥是公开的，顾名思义，就是你可以随意分发给网络上的任何其他人，但这个私钥匙是严格保密的。别人要给你发加密信息怎么办，就是别人用你的公钥把信息进行加密，然后把这个信息发给你，你收到这个信息之后，你就可以用自己的私钥去对它解密，获取这个信息的明文。你要看清它的特点，别人给你发信息，其实是用你的公钥来进行加密，那为什么要搞这种非对称加密体系呢？</p>
<p>刚才那种对称加密体系，有一个比较明显的缺陷，加解密同一把密钥，我这个密钥必须要设法告诉别人，那我这个告诉别人的过程，比如说不管是打电话写邮件，我这个密码就有可能就在这个过程中被泄露了。而非对称加密体系就没有这个问题，别人是用我的公钥来加密的，别人可以把加密过的信息非常放心的，放在网络上的任何地方，给网上所有人去看，没有任何问题，因为只有私钥的人才能去解密这个信息，还原出这个信息的内容。因为加解密使用不一样密钥，所以它被称为非对称加密体系。<br />
在非对称加密体系中公钥和私钥是一一对应的，很明显通过公钥是肯定无法计算出私钥的，否则这个加密体系就不成立了。那通过私钥能不能计算出公钥，这个问题就不是很要紧了。有些非对称加密的方法是私钥算不出公钥，但有些是可以算出公钥，但这个不要紧，要紧的就是通过公钥是算不出私钥的。</p>
<p>另外有一个有趣的特点，其实私钥也是可以用来加密的，我用我自己的私钥也可以对一段信息进行加密，任何人用我的公钥可以把这段信息还原，还原出它的明文。那你会说这有什么用呢？我加密一个信息，但是每个人都能还原出它的原文，这有什么作用呢？它有一个非常好的作用，就是它跟我们现实生活中的签名非常相类似。比如说我把这样一段信息，用我的私钥加密，我加密一下：“我欠张三10块钱”，我把这几个字用我的私钥加密，分发到网上，别人用我的公钥对它解密，一看真的确实是还原出“我欠张三10块钱”这几个字，那别人就可以确信这段信息肯定是我的电脑里签名签出来的，就是用我的私钥才能产生的信息，其他任何人都没有办法产生同样的这段加密过的信息。你看这样是不是起到了一个签名的作用，而且比生活中手写的签名更加强力无数倍，因为我连抵赖的资格都没有，因为别人确信只有拥有我的私钥的人才能产生这样一段信息。<br />
而且这段信息还有很强的防篡改的作用，就是说假设有另外一个人李四，李四拿到了我加密过的“我欠张三10块钱”这个加密过的信息，然后李四说，我能不能修改一下这段文字，产生另外一段加密的文字，文字还原出来变成“我欠李四10块钱”。那可以很明确的告诉你，李四肯定是做不到的，或者说他要做到这一点需要几百年的时间才能尝试出来，所以我很放心。<br />
这就是非对称加密体系中另一个很有用的作用，也是在比特币里面经常用到的, 就是签名的作用。就是说我能产生一段信息，这段信息能使得所有网络上的所有人确信是某一个特定的人才能产生的信息，这就是俗称的签名。</p>
<p>然后大家要理解比特币的话，要牢记一个比特币的中心设计理念，就是所谓的“去中心化”四个字，什么是中心化？你可以想象一下我们现实中的货币，这些货币都是以国家的名义进行发行，然后用国家的信用来担保，这个货币的发行以及它的一些使用的政策，都是一个国家政府的名义来进行操作的，这都是中心化的。而比特币的设计理念就是要去中心化，就是说这个货币没有任何一个中心的人，中心的组织能够控制它，去操作它的一个东西。为什么会有这样一个东西？其实从网络一诞生就有很多那种理想主义者，觉得通过网络所有的人能够平等的交往，所以他们觉得能不能发明一种数字化的货币，也不需要任何人来管理，就是它自己运转起来，这种想法是很吸引人的，但是难度也是非常大的，那就让我们来看看比特币是怎么克服一些技术上的困难。</p>
<p>首先第一个要解决的问题就是身份验证问题，就是说某一笔钱到底是属于谁的，怎么确定这个拥有者的身份？正好我前面已经提过了，非对称加密体系里面有公钥，这个东西就是公共的钥匙，这个公钥用做身份验证就是很自然而然的一件事情。因为这个公钥可以完全放心的公开，在网上发布给每一个人，你对你的账户的那个所有的操作很明显就是靠你的私钥来保证，你必须拥有私钥你才能对你的账户进行操作。所以大家请记住，如果你要参与比特币这个游戏的时候，你对你的私钥必须做到非常严格的保护，因为私钥一旦被泄露，你的账户等于是完全公开给别人，你也没有办法像现实中，你还可以打电话给银行说我要冻结我的账户，你在比特币里面完全没有这种说法，别人拿到你的私钥，他就可以立即对你的账户进行任何操作，也没有办法冻结，也没有什么所谓的挂失，或者我要重置一下密码，都没有这些东西。就是说所有的一切都是靠私钥来确定，这就是身份验证的问题，就这样解决了。</p>
<p>第二个问题就是账户信息，也就是说谁某一个账户拥有多少钱，这个信息到底存在哪里。既然比特币的设计理念是去中心化，那么这个账户信息只存在一个或者几个人的电脑里就不太合适，<br />
所以按中本聪的很天才的想法，就让所有人都有所有人的账户信息。你会说你这样不是没有隐私权了，我一眼就能看出某个账户有这么多比特币，某个账户是很有钱的人。但这完全没有关系，因为每个人公开在网上信息只是一串公钥，就是一串数字而已，这个公钥背后是是谁，完全不知道！只要你不主动主动去说这个账户是我的，那别人是没办法知道你的。所以所有人的账户信息是存在每一个人的电脑上。<br />
那你又会说如果有一个“坏人”，或者说我对我自己的账户进行修改。明明我的账户本来是十块钱，我偷偷的在自己电脑上改，我在电脑上把自己的账户改成一百块钱。但这样的修改是没有用的，因为每个人的机器上都有账户信息，如果你自己一个人修改了，你跟别人的电脑上账本对不上，那你就没办法继续参与这个游戏了。简单而言，也就是说这个比特币游戏有一个叫少数服从多数的原则，你的修改如果得不到多数人的认同，你就没办法继续参与这个游戏，你的数据跟别人保持一样，你才能继续玩下去这个游戏，关于比特币如何存储账户信息就这样解决。<br />
接下来一个问题就是要解决转账问题，转账问题就是说我怎么能够把我个人的账户里的钱转到另一个人的账户，很显然我在发起一条转账信息的时候，你会想那我就向所有参与这个比特币游戏的人广播出去，比如说我向张三转一个比特币，那我就把这条消息广播给所有人，然后所有人接收到这个消息的时候，就找到他自己本地电脑上我的账户，把我的账户减掉一个比特币，然后把<br />
张三的账户加入一个比特币，这样就解决了这个问题，而且很显然我这个转账这个信息必须是我进行签名的，这样别人就不能仿冒我，伪造一条转账的信息。<br />
听上去好像这个问题很简单，但其实这里还有一个非常大的陷阱。比如设想这种情况，假设我的账户里只有一块钱，然后我准备两台电脑，在第一台电脑上我准备一条信息，叫“我给张三转一块钱”，然后我在另外一台电脑上准备另一条信息，我给”李四转一块钱“。然后我两台电脑同时按回车，两条信息差不多同一时刻发出去，其他人接到我的这两个信息一看都是从我的账户里转出去，但一个是转给张三一块钱，另一条转给李四一块钱。但是再一看我的账户里总共只有一块钱，然后这样就不行了吗？这两条信息里面必定只能有一条被接受，另外一条不能被接受。这个问题怎么解决？这个问题也是所有数字化虚拟货币要解决的，可以说是唯一一个，而且是最重大的一个技术难题，叫所谓的double spending，中文翻译可以叫“双重使用”的问题。就是我同一份钱，我用两次。怎么能够防止这种情况的发生？<br />
你很自然地想到那我可以根据先来后到的原则吗？即使你发两条信息，你是同时按回车的，但是我接到两个信息里面总是有一个先来后到的，那么我总是直接接受先到的这条信息。比如说我先收到“我转给张三”这条信息，那么就视为接受这条信息，然后“我转账给李四”，这条信息是后来的，但是那时候你的账户已经被已经是零元了，那我就不能接受这条转账。<br />
但这样有一个问题在，你现在回到这个比特币设计的理念，去中心化，也就是说网络上有无数的人，参与这个游戏的人都是平等的来接收到这两条信息。但是网络的状态又是千变万化，可能对你来说，你是先收到“我转账给张三”的这条信息，但有其他人的电脑有可能先收到“转账给李四”的那条信息，这是很自然的很可能发生的，那你说这个这种情况怎么处理呢？到底听从谁的电脑呢，这是一个很困难的问题。</p>
<p>历史上在比特币之前，有人提出一种设想，就是每个人在转账之前，他必须同时把转账的这个需求发送到某一个公共的论坛上，也就是说我要在这个论坛上留下同样一条信息，“转账张三一块钱”。所有人在接收到转账的需求的时候都要到这个论坛上去核对一下，看一下论坛上有没有同样的这条转账的信息，如果有的话才能够接受，因为这个论坛的帖子肯定会有一个时间戳，也就是有先来后到的，那么如果某一个人同时发了两条，那么对其他所有接收到信息的人，永远以这个论坛上的时间戳来确定转账的先后顺序。这样当然能够能够解决问题了，但是它的缺点就很明显，它违背了比特币这个“去中心化”的这个理念，也就是这个论坛，你到底选择什么样的论坛呢？这个论坛谁来维护？如果这个论坛的信息被黑客攻击，这个论坛万一当机了，那大家这个转账都不能不能操作了，这些问题怎么解决？这个论坛不可避免地成为另外一个中心，所以这就违背了比特币的去中心化的理念。<br />
所以比特币就想了一套新的非常神奇，很有意思的方法来解决这个问题。可能你也听出来了，问题的核心要点，就是要确定两条交易的时间先后顺序，而确定这个时间先后又需要在去中心化的方法下达成。比特币用的方法就是把所有的交易按照时间顺序串成一个链条，这个链条叫做区块链，也是每一个区块都是有一个前面的区块和后面的一个去块，连成一条链条状的东西，而每一个区块都包含了一条或多条交易信息，一旦某一个交易作为某个区块的一部分被加入这个区块链之后，它的合法性或者说它的真实性就得到了一定的确认。但请注意只是一定程度上确认，而这个区块链的设计，又使得当一个区块后面又增加了一个新的区块，后面区块在某种程度上又加强了前一块区块的合法性和真实性。</p>
<p>那这套机制到底是怎么实现的呢？我们就得先讲一个准备知识，叫做Hash函数，中文有时候翻译成哈希，这个哈希函数是怎么样一个东西呢？它的输入参数是一块字符串，或者说一串数字，<br />
它的输出也是一串数字，一般是确定长度的一个数字，这是由这个哈希函数性质来确定。比如说它可以是521位，1024位，2048位，这就是它输出的长度，是事先确定的，但输入的字符串是任意长度的，无所谓，可以是一个字节，一篇文章或者是几张光盘，所有的信息都可以作为它的输入。<br />
哈希函数的输入输出达到一个什么效果？它有两个效果，一个就是单向操作。当有一个输入，这个哈希函数可以很快地算出一个输出。但是逆向操作是非常困难的，就是根据输出的结果要找出它是根据哪个原文算出来的这个结果，这是非常困难的。比如说有一种非常常见的哈希函数叫SHA算法，你的电脑里可能就有一个叫shasum的命令。我就用我的电脑算了一下，比如说“大老李”这三个汉字，在电脑里本质上也是一串数字，所以这三个汉字也是可以产生一个哈希的结果，然后这三个汉字用SHA256算法算出来的哈希的输出是“ac93b7f7b6128099c76f7959acac7a6a71897286fbad7f06eed546923f4fffd8”，一共有64位16进制也就是1024比特，我现在给你看这串输出，我告诉你，这是某一个字符串的SHA256算法的输出。我可以很确信，你没办法在短时间内算出它是怎样一个字符串的输入，但是你可以用电脑很容易地验证，就是用“大老李”三个字验证，它的输出确实是这样一串字符串，这就是哈希函数的第一个特点，叫单向操作，就是不可逆函数，它的逆操作是非常难操作的，算法时间非常久。<br />
另外一个性质呢叫所谓的抗碰撞，理论上两个不同的字符串，会可能会产生同样的哈希结果，<br />
这个道理很简单，因为它的输入是是任意长度的字符串，可短可长，这就无数种输入，<br />
但它输出却是一个定长的，就是输出输出结果，只有有限种结果。那我们根据鸽笼原理，输入有无穷多可能，输出有限，那你肯定输入跟输出的关系肯定是多对一的，也就是说肯定会有多种<br />
不同的输入会产生同样的输出。</p>
<p>那哈希函数的另外一个特点就是说抗碰撞，我告诉你某一个输入会产生这样的输出，你很难找出<br />
两个不同的输入都能产生同样的输出。比如说我刚才告诉你我已经告诉你“大老李”的那个SH256的速度这样一串数字，那你能不能再找出另外其他一种字符串也能产生这样一个输出呢？<br />
虽然理论上讲肯定会有无数种可能输入，这种可能都能产生同样的输出，但是你还是没办法在短<br />
短时间内算出这样的字符串，这就是所谓的抗碰撞。如果两个字符串或者两个数字两个输入的那个二进制输入它的输出是一样的哈希输出是一样的，我们就是说它们是碰撞了。<br />
<img class="alignnone size-full wp-image-590" src="https://dalaoliblog.files.wordpress.com/2017/11/collision.png" alt="Collision.png" width="290" height="205" /></p>
<p>但哈希函数的一个特点要求就是抗碰撞，凡是满足这种，一个是单向单向操作，一个是抗碰撞的算法函数会经常被作为哈希函数。那哈希函数有什么用？一个最常见的用途就是对明文信息的校验，比如说我有一个很大的软件放在网上供你下载，它可能是一个Linux操作系统，一个光盘的镜像，它可能有几个G，那你下载下来的时候，当然是希望你下载下来的东西跟我的原来的内容是一模一样的，那我通常会在网站上再给告诉你，你下载出来的时候，这个光盘的镜像用哈希校验一下它的输出结果会是怎样一个结果，那你下载下来之后在本机跑一下ShaSum，你就可以验证一下你下载下来的文件的哈希的输出跟我网站上公布的输出是不是一样的？如果是一样的，那你肯定很确信的。你下载的这个镜像没有损坏，而且没有遭到别人的恶意篡改。你这时候可能会想想我前面不是说过那个私钥公钥体系吗？如果我如果怕呃篡改或者需要校验的话，为什么我不是把那个光盘镜像用我的私钥进行加密，然后供用户下载，用户先用公钥解密，如果能够正常解密，那这个信息肯定是正确的，而且是未经篡改。</p>
<p>那这个这时候哈希其实就比私钥公钥这种方法有两个好处，一个是使用公钥私钥体系是有点麻烦的，因为我需要让用户要下载到我的公钥，那不是每个用户都会知道加解密的那个操作。那个SHA校验或者哈希的校验现在主流操作系统都有了，而且这个命令是相当简单。另外一个更重要的区别，一般来说非对称加密体系的，不管是用公钥还是用私钥加密一个信息，都会使这个<br />
加密的信息量要翻倍。也就是说假设明文信息是一个G，你加密完，你看这个信息就可能变成两个G了，这就大大增加了这个开销，所以这是很不方便的。所以这就是哈希函数用做校验和防篡改的作用，</p>
<p>另外一个可能更常用这种作用的就是密码存储，你有没有想过就是说你在任何一个网站上<br />
注册，然后你肯定要设定一个密码，你可能以为对方网站会直接把你的密码密码存储在他的服务器上，但其实那样应该不是正常的网站。正常的网站，就不应该把用户的密码作为明文存储起来，而它肯定是把密码用某个哈希函数处理，然后把这个哈希输出的结果存储起来，为什么要这样存储起来呢？</p>
<p>首先，用这种方法还是可以作为用户信息的验证没有问题，你下次登录的时候你输入你的密码，网站同样把你的函数用它设定的那个哈希函数进行一次，进行转换，然后再把转换的结果跟它的数据库里面存储的结果进行比较，如果是一致的话，那么他就认为你输入的密码是正确的，这样做最大的好处呢，就是防泄漏了，因为前面说过这个哈希函数的逆向计算是非常困难，所以即使我的网站里面存储的这个密码被泄露了，被黑客偷走了，那他偷到的也是一串哈希的输出，<br />
那至少这增加了黑客的难度，他要通过这个哈希的输出反推出你的密码是很困难的。这时候你也看出这个防碰撞的重要性，也就是黑客其实拿到哈希输出的话，它并不需要准确的反算出你的你的密码的原文，它只要找出任何一个原文能够产生同样的哈希输出就可以。如果如果一个哈希函数它的没有反碰撞的能力的话，那么黑客有可能就比较快的能够找到找到了他的原文，这也是不可以的。</p>
<p>所以如果有时候我注册一个网站，我的我的邮箱会收到一份邮件，他会告诉我欢迎你来注册，你的你的用户名是什么，你的密码是什么，如果这时候它告诉它在这个邮件里还能显示我的密码原文，那我就会感到非常恐怖，因为我知道这个网站肯定没不是用用哈希函数来存储我的密码，而是把我的密码原文存储在他的网站上，这是非常非常危险的操作，所以这种网站我一旦出现的话，我肯定不会用我常用的密码，我会肯定只能用一个我临时的密码随便应付一下，或者我根本不敢用他的这个网站。<br />
另外顺便说一下，有很多“坏人”，这个“坏人”要打引号。就是有这样这样一帮人，他们会把一些用户常用的密码常用的哈希函数全部去算一遍，比如说多少位以内的字母组合，然后全部常用的哈希函数算一遍，然后存储在数据库里面，然后做一个索引，这样他一旦偷到某个网站的数据库啊信息，然后发现里面的密码的那个哈希函数用的正好是他已经用过的那种，如果你的那个密码又是它常用的所谓的弱密码的话，那么它们就能通过这个数据库很快的查出来你的那个密码的原文，这是非常常见的一个黑客攻击的手段，所以这也提醒我们在设置密码的时候不能设置的过于简单，然后节目到现在这一期时间长度也差不多了，那么我们下半期会继续讲比特币是如何利用哈希函数来实现区块链的，</p>
<p>敬请期待，再见。</p>
<p>收听“大老李聊数学”：</p>
<p><img class="alignnone size-full wp-image-380" src="https://dalaoliblog.files.wordpress.com/2017/10/ximalaya.png" alt="ximalaya" width="298" height="286" /></p>
<p>“大老李聊数学”订阅号：</p>
<p><img class="alignnone size-full wp-image-151" src="https://dalaoliblog.files.wordpress.com/2017/09/qrcode_for_gh_130ed4d8263c_344.jpg" alt="qrcode_for_gh_130ed4d8263c_344" width="344" height="344" /></p>
</div></article>
            </div>
          </div></div></div>

      <div class="page__footer">
<div class="footer js-page-footer">
  <div class="main"><aside  itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大老李"><meta itemprop="url" content="https://dalaoli-shuxue.github.io/"><meta itemprop="description" content="I am an amazing person."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><link itemprop="url" href="https://dalaoli-shuxue.github.io/"><li title="给我发邮件。">
      <a class="button button--circle mail-button" itemprop="email" href="mailto:liyouhua@gmail.com" target="_blank">
        <i class="fas fa-envelope"></i>
      </a></ul>
</div>
</div>
    </aside>
    <footer class="site-info"><p class="menu menu--center">
        <span>© 大老李聊数学 2018</span>
        <a type="application/rss+xml" href="/feed.xml">RSS</a>
      </p>
      <p>Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> & <a
        title="TeXt is a succinct theme for blogging." href="https://github.com/kitian616/jekyll-TeXt-theme">TeXt Theme</a>.
      </p>
    </footer>
  </div>
</div></div>
    </div>
  </div><div class="page__search-panel"><div class="search">
  <div class="main">
    <div class="search__header">搜索</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--secondary button--pill search__cancel js-search-toggle">
        取消</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>

<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var searchData = window.TEXT_SEARCH_DATA ? initData(window.TEXT_SEARCH_DATA) : {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  function initData(data) {
    var _data = [], i, j, key, keys, cur;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i], _data[key] = [];
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        cur.title = window.decodeUrl(cur.title);
        cur.url = window.decodeUrl(cur.url);
        _data[key].push(cur);
      }
    }
    return _data;
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) {
      return null;
    }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $searchBox = $('.js-search-box');
  var $searchInput = $searchBox.children('input');
  var $searchClear = $searchBox.children('.js-icon-clear');
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function searchBoxEmpty() {
    $searchBox.removeClass('not-empty'); $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }

  $searchInput.on('input', window.throttle(function() {
    var val = $(this).val();
    if (val === '' || typeof val !== 'string') {
      searchBoxEmpty();
    } else {
      $searchBox.addClass('not-empty'); $result.html(render(searchByQuery(val)));
      $resultItems = $('.search-result__item'); activeIndex = 0;
      $resultItems.eq(0).addClass('active');
    }
  }, 400));
  $searchInput.on('focus', function() {
    $(this).addClass('focus');
  });
  $searchInput.on('blur', function() {
    $(this).removeClass('focus');
  });
  $searchClear.on('click', function() {
    $searchInput.val(''); searchBoxEmpty();
  });

  // search panel
  var $pageRoot = $('.js-page-root');
  var $searchToggle = $('.js-search-toggle');
  var showSearch = false;

  function closeSearchPanel() {
    $pageRoot.removeClass('show-search-panel');
    $searchInput[0].blur();
    setTimeout(function() {
      $searchInput.val(''); searchBoxEmpty();
      window.pageAsideAffix && window.pageAsideAffix.refresh();
    }, 400);
  }
  function openSearchPanel() {
    $pageRoot.addClass('show-search-panel');
    $searchInput[0].focus();
  }

  // Char Code: 13  Enter, 27  ESC, 37  ⬅, 38  ⬆, 39  ➡, 40  ⬇, 83  S, 191 /
  function isFormElement(e) {
    var tagName = e.target.tagName || e.srcElement.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  }
  function charCodeFilter(e) {
    return e.target === $searchInput[0] && (e.which === 13 || e.which === 27 || e.which === 38 || e.which === 40);
  }

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  $(document).on('keyup', function(e) {
    if (!isFormElement(e) || charCodeFilter(e)) {
      if (e.which === 83 || e.which === 191) {
        showSearch || (showSearch = true, openSearchPanel());
      } else if (e.which ===  27) {
        showSearch && (showSearch = false, closeSearchPanel());
      } else if (e.which === 38) {
        showSearch && moveActiveIndex('up');
      } else if (e.which === 40) {
        showSearch && moveActiveIndex('down');
      } else if (e.which === 13) {
        showSearch && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });

  $searchToggle.on('click', function() {
    showSearch = !showSearch;
    showSearch ? openSearchPanel() : closeSearchPanel();
  });
});</script></div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $root, $scrollTarget, $scroller, $scroll;
    var rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop;
    var offsetBottom = 0, disabled = false, scrollTarget = window, scroller = 'html, body', scroll = window.document;
    var hasInit = false, isOverallScroller = true, curState;

    function setOptions(options) {
      var _options = options || {};
      _options.offsetBottom && (offsetBottom = _options.offsetBottom);
      _options.scrollTarget && (scrollTarget = _options.scrollTarget);
      _options.scroller && (scroller = _options.scroller);
      _options.scroll && (scroll = _options.scroll);
      _options.disabled !== undefined && (disabled = _options.disabled);
      $scrollTarget = $(scrollTarget);
      $scroller = $(scroller);
      isOverallScroller = window.isOverallScroller($scrollTarget[0]);
      $scroll = $(scroll);
    }
    function initData() {
      top();
      rootHeight = $root.outerHeight();
      rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
      rootLeft = $root.offset().left;
    }
    function calc(needInitData) {
      needInitData && initData();
      scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
      rootBottomTop = scrollBottom - rootTop;
    }
    function top() {
      if (curState !== 'top') {
        $root.removeClass('fixed').css({
          left: 0,
          top: 0
        });
        curState = 'top';
      }
    }
    function fixed() {
      if (curState !== 'fixed') {
        $root.addClass('fixed').css({
          left: rootLeft + 'px',
          top: 0
        });
        curState = 'fixed';
      }
    }
    function bottom() {
      if (curState !== 'bottom') {
        $root.removeClass('fixed').css({
          left: 0,
          top: rootBottomTop + 'px'
        });
        curState = 'bottom';
      }
    }
    function setState() {
      var scrollTop = $scrollTarget.scrollTop();
      if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
        fixed();
      } else if (scrollTop < rootTop) {
        top();
      } else {
        bottom();
      }
    }
    function init() {
      if(!hasInit) {
        var interval, timeout;
        calc(true); setState();
        // run calc every 100 millisecond
        interval = setInterval(function() {
          calc();
        }, 100);
        timeout = setTimeout(function() {
          clearInterval(interval);
        }, 45000);
        window.pageLoad.then(function() {
          setTimeout(function() {
            clearInterval(interval);
            clearTimeout(timeout);
          }, 3000);
        });
        $scrollTarget.on('scroll', function() {
          disabled || setState();
        });
        $window.on('resize', function() {
          disabled || (calc(true), setState());
        });
        hasInit = true;
      }
    }

    function affix(options) {
      $root = this;
      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $root, $scrollTarget, $scroller, $tocUl = $('<ul class="toc"></ul>'), $tocLi, $headings, $activeLast, $activeCur;
    var selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false;
    var headingsPos, scrolling = false, rendered = false, hasInit = false;
    function setOptions(options) {
      var _options = options || {};
      _options.selectors && (selectors = _options.selectors);
      _options.container && (container = _options.container);
      _options.scrollTarget && (scrollTarget = _options.scrollTarget);
      _options.scroller && (scroller = _options.scroller);
      _options.disabled !== undefined && (disabled = _options.disabled);
      $headings = $(container).find(selectors);
      $scrollTarget = $(scrollTarget);
      $scroller = $(scroller);
    }
    function calc() {
      headingsPos = [];
      $headings.each(function() {
        headingsPos.push(Math.floor($(this).position().top));
      });
    }
    function setState(element, disabled) {
      var scrollTop = $scrollTarget.scrollTop(), i;
      if (disabled || !headingsPos || headingsPos.length < 1) { return; }
      if (element) {
        $activeCur = element;
      } else {
        for (i = 0; i < headingsPos.length; i++) {
          if (scrollTop >= headingsPos[i]) {
            $activeCur = $tocLi.eq(i);
          } else {
            $activeCur || ($activeCur = $tocLi.eq(i));
            break;
          }
        }
      }
      $activeLast && $activeLast.removeClass('active');
      ($activeLast = $activeCur).addClass('active');
    }
    function render() {
      if(!rendered) {
        $root.append($tocUl);
        $headings.each(function() {
          var $this = $(this);
          $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
            .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
        });
        $tocLi = $tocUl.children('li');
        $tocUl.on('click', 'a', function(e) {
          e.preventDefault();
          var $this = $(this);
          scrolling = true;
          setState($this.parent());
          $scroller.scrollToAnchor($this.attr('href'), 400, function() {
            scrolling = false;
          });
        });
      }
      rendered = true;
    }
    function init() {
      var interval, timeout;
      if(!hasInit) {
        render(); calc(); setState(null, scrolling);
        // run calc every 100 millisecond
        interval = setInterval(function() {
          calc();
        }, 100);
        timeout = setTimeout(function() {
          clearInterval(interval);
        }, 45000);
        window.pageLoad.then(function() {
          setTimeout(function() {
            clearInterval(interval);
            clearTimeout(timeout);
          }, 3000);
        });
        $scrollTarget.on('scroll', function() {
          disabled || setState(null, scrolling);
        });
        $window.on('resize', window.throttle(function() {
          if (!disabled) {
            render(); calc(); setState(null, scrolling);
          }
        }, 100));
      }
      hasInit = true;
    }
    function toc(options) {
      $root = this;
      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();/*(function () {

})();*/</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();</script>
    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();</script>
  </body>
</html>